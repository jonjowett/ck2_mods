namespace = ekmaintenance

character_event = { #Destroy relevant Titular Kingdoms when you acquire a High Kingdom
	id = ekmaintenance.0
	is_triggered_only = yes #on_new_holder
	hide_window = yes
	
	trigger = { 
		OR = {
			has_landed_title = k_highrock
			has_landed_title = k_skyrim
			has_landed_title = k_morrowind
			has_landed_title = k_hammerfell
			has_landed_title = k_cyrodiil
			has_landed_title = k_valenwood
			has_landed_title = k_elsweyr
			has_landed_title = k_argonia
			has_landed_title = k_summerset
			has_landed_title = k_pyandonea
			has_landed_title = k_yokuda
		}
	}
	
	immediate = {
		#Argonia Block
		if = {
			limit = { has_landed_title = k_argonia } 
			if = {
				limit = { has_landed_title = k_lilmoth }
				k_lilmoth = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_stormhold }
				k_stormhold = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_thorn }
				k_thorn = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_soulrest }
				k_soulrest = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_gideon }
				k_gideon = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_helstrom }
				k_helstrom = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_blackrose }
				k_blackrose = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_archon }
				k_archon = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_murkwood }
				k_murkwood = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_topalsea }
				k_topalsea = { destroy_landed_title = THIS }
			}
			break = yes
		}
		#Cyrodiil Block
		if = {
			limit = { has_landed_title = k_cyrodiil	}
			if = {
				limit = { has_landed_title = k_colovia }
				k_colovia = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_nibenay }
				k_nibenay = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_canulus }
				k_canulus = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_topalsea }
				k_topalsea = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_blackwood }
				k_blackwood = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_cheydinhal }
				k_cheydinhal = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_anvil }
				k_anvil = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_skingrad }
				k_skingrad = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_kvatch }
				k_kvatch = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_heartlands }
				k_heartlands = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_chorrol }
				k_chorrol = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_bravil }
				k_bravil = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_bruma }
				k_bruma = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_leyawiin }
				k_leyawiin = { destroy_landed_title = THIS }
			}
			break = yes
		}
		#High Rock Block
		if = {
			limit = { has_landed_title = k_highrock } 
			if = {
				limit = { has_landed_title = k_daggerfall }
				k_daggerfall = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_camlorn }
				k_camlorn = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_wayrest }
				k_wayrest = { destroy_landed_title = THIS }
			}
			# if = {
				# limit = { has_landed_title = k_orsinium }
				# k_orsinium = { destroy_landed_title = THIS }
			# }
			if = {
				limit = { has_landed_title = k_wrothgarian }
				k_wrothgarian = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_northpoint }
				k_northpoint = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_balfiera }
				k_balfiera = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_sharnhelm }
				k_sharnhelm = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_evermore }
				k_evermore = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_jehenna }
				k_jehenna = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_bangkorai }
				k_bangkorai = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_betony }
				k_betony = { destroy_landed_title = THIS }
			}
			break = yes
		}
		#Skyrim Block
		if = {
			limit = { has_landed_title = k_skyrim } 
			if = {
				limit = { has_landed_title = k_solitude }
				k_solitude = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_whiterun }
				k_whiterun = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_hjaalmarch }
				k_hjaalmarch = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_winterhold }
				k_winterhold = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_eastmarch }
				k_eastmarch = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_falkreath }
				k_falkreath = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_therift }
				k_therift = { destroy_landed_title = THIS }
			}
			if = {
				limit = {
					has_landed_title = k_thereach
					NOT = { has_global_flag = reach_de_jure_kingdom_formed }
				}
				k_thereach = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_thepale }
				k_thepale = { destroy_landed_title = THIS }
			}
			# if = {
				# limit = { has_landed_title = k_volkihar }
				# k_volkihar = { destroy_landed_title = THIS }
			# }
			break = yes
		}
		#Hammerfell Block
		if = {
			limit = { has_landed_title = k_hammerfell } 
			if = {
				limit = { has_landed_title = k_sentinel }
				k_sentinel = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_skaven }
				k_skaven = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_gilane }
				k_gilane = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_rihad }
				k_rihad = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_hnas }
				k_hnas = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_taneth }
				k_taneth = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_elinhir }
				k_elinhir = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_dragontail }
				k_dragontail = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_hegathe }
				k_hegathe = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_strosmkai }
				k_strosmkai = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_thechain }
				k_thechain = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_craglorn }
				k_craglorn = { destroy_landed_title = THIS }
			}
			break = yes
		}
		#Yokuda Block
		if = {
			limit = { has_landed_title = k_yokuda } 
			if = {
				limit = { has_landed_title = k_systres }
				k_systres = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_ravan }
				k_ravan = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_vath }
				k_vath = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_akoskasaz }
				k_akoskasaz = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_thechain }
				k_thechain = { destroy_landed_title = THIS }
			}
			break = yes
		}
		#Morrowind Block
		if = {
			limit = { has_landed_title = k_morrowind } 
			if = {
				limit = { has_landed_title = k_mournhold }
				k_mournhold = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_blacklight }
				k_blacklight = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_tear }
				k_tear = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_ebonheart }
				k_ebonheart = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_narsis }
				k_narsis = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_necrom }
				k_necrom = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_ashlands }
				k_ashlands = { destroy_landed_title = THIS }
			}
			break = yes
		}
		#Pyandonea Block
		if = {
			limit = { has_landed_title = k_pyandonea } 
			if = {
				limit = { has_landed_title = k_abbarbas }
				k_abbarbas = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_pyrrahn }
				k_pyrrahn = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_pontu }
				k_pontu = { destroy_landed_title = THIS }
			}
			break = yes
		}
		#Summerset Block
		if = {
			limit = { has_landed_title = k_summerset } 
			if = {
				limit = { has_landed_title = k_alinor }
				k_alinor = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_auridon }
				k_auridon = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_shimmerene }
				k_shimmerene = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_lillandril }
				k_lillandril = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_systres }
				k_systres = { destroy_landed_title = THIS }
			}
			break = yes
		}
		#Valenwood Block
		if = {
			limit = { has_landed_title = k_valenwood } 
			if = {
				limit = { has_landed_title = k_falinesti }
				k_falinesti = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_eldenroot }
				k_eldenroot = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_eldengrove }
				k_eldengrove = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_arenthia }
				k_arenthia = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_cormount }
				k_cormount = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_silvenar }
				k_silvenar = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_haven }
				k_haven = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_southpoint }
				k_southpoint = { destroy_landed_title = THIS }
			}
			break = yes
		}
		#Elsweyr Block
		if = {
			limit = { has_landed_title = k_elsweyr } 
			if = {
				limit = { has_landed_title = k_riverhold }
				k_riverhold = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_senchal }
				k_senchal = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_rimmen }
				k_rimmen = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_anequina }
				k_anequina = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_pellitine }
				k_pellitine = { destroy_landed_title = THIS }
			}
			if = {
				limit = { has_landed_title = k_topalsea }
				k_topalsea = { destroy_landed_title = THIS }
			}
			break = yes
		}
	}
}

character_event = { #Chooses proper event depending on the situation of the Great House
	id = ekmaintenance.1
	is_triggered_only = yes #on_new_holder
	hide_window = yes
	
	trigger = {
		NOT = { has_character_flag = running_maintenance }
		FROM = { is_dunmer_great_house_title = yes }		
	}
	
	immediate = {
		set_character_flag = running_maintenance
		#Doesn't have proper House Trait
		if = {
			limit = { 
				OR = {
					has_landed_title = k_hlaalu
					has_landed_title = d_hlaalu
				}
				NOT = { trait = house_hlaalu }
			}
			character_event = { id = ekmaintenance.2 days = 2 }
			break = yes
		}
		#Has proper House Trait but isn't Grandmaster
		if = {
			limit = { 
				trait = house_hlaalu
				OR = {
					has_landed_title = k_hlaalu
					has_landed_title = d_hlaalu
				}
				NAND = { 
					society_member_of = house_hlaalu_council
					is_society_grandmaster = yes
				}
			}
			character_event = { id = ekmaintenance.3 days = 2 }
			break = yes
		}
		
		if = {
			limit = { 
				OR = {
					has_landed_title = k_indoril
					has_landed_title = d_indoril
				}
				NOT = { trait = house_indoril }
			}
			character_event = { id = ekmaintenance.2 days = 2 }
			break = yes
		}
		if = {
			limit = { 
				trait = house_indoril
				OR = {
					has_landed_title = k_indoril
					has_landed_title = d_indoril
				}
				NAND = { 
					society_member_of = house_indoril_council
					is_society_grandmaster = yes
				}	
			}
			character_event = { id = ekmaintenance.3 days = 2 }
			break = yes
		}
		
		if = {
			limit = { 
				OR = {
					has_landed_title = k_dres
					has_landed_title = d_dres
				}
				NOT = { trait = house_dres }
			}
			character_event = { id = ekmaintenance.2 days = 2 }
			break = yes
		}
		if = {
			limit = { 
				trait = house_dres
				OR = {
					has_landed_title = k_dres
					has_landed_title = d_dres
				}
				NAND = { 
					society_member_of = house_dres_council
					is_society_grandmaster = yes
				}	
			}
			character_event = { id = ekmaintenance.3 days = 2 }
			break = yes
		}
		
		if = {
			limit = { 
				OR = {
					has_landed_title = k_redoran
					has_landed_title = d_redoran
				}
				NOT = { trait = house_redoran }
			}
			character_event = { id = ekmaintenance.2 days = 2 }
			break = yes
		}
		if = {
			limit = { 
				trait = house_redoran
				OR = {
					has_landed_title = k_redoran
					has_landed_title = d_redoran
				}
				NAND = { 
					society_member_of = house_redoran_council
					is_society_grandmaster = yes
				}	
			}
			character_event = { id = ekmaintenance.3 days = 2 }
			break = yes
		}
		
		if = {
			limit = { 
				OR = {
					has_landed_title = k_telvanni
					has_landed_title = d_telvanni
				}
				NOT = { trait = house_telvanni }
			}
			character_event = { id = ekmaintenance.2 days = 2 }
			break = yes
		}
		if = {
			limit = { 
				trait = house_telvanni
				OR = {
					has_landed_title = k_telvanni
					has_landed_title = d_telvanni
				}
				NAND = { 
					society_member_of = house_telvanni_council
					is_society_grandmaster = yes
				}	
			}
			character_event = { id = ekmaintenance.3 days = 2 }
			break = yes
		}
		
		if = {
			limit = { 
				OR = {
					has_landed_title = k_sul
					has_landed_title = d_sul
				}
				NOT = { trait = house_sul }
			}
			character_event = { id = ekmaintenance.2 days = 2 }
			break = yes
		}
		if = {
			limit = { 
				trait = house_sul
				OR = {
					has_landed_title = k_sul
					has_landed_title = d_sul
				}
				NAND = { 
					society_member_of = house_sul_council
					is_society_grandmaster = yes
				}	
			}
			character_event = { id = ekmaintenance.3 days = 2 }
			break = yes
		}
		
		if = {
			limit = { 
				OR = {
					has_landed_title = k_sadras
					has_landed_title = d_sadras
				}
				NOT = { trait = house_sadras }
			}
			character_event = { id = ekmaintenance.2 days = 2 }
			break = yes
		}
		if = {
			limit = { 
				trait = house_sadras
				OR = {
					has_landed_title = k_sadras
					has_landed_title = d_sadras
				}
				NAND = { 
					society_member_of = house_sadras_council
					is_society_grandmaster = yes
				}	
			}
			character_event = { id = ekmaintenance.3 days = 2 }
			break = yes
		}
		
		if = {
			limit = { 
				OR = {
					has_landed_title = k_dagoth
					has_landed_title = d_dagoth
				}
				NOT = { trait = house_dagoth }
			}
			character_event = { id = ekmaintenance.2 days = 2 }
			break = yes
		}
		if = {
			limit = { 
				trait = house_dagoth
				OR = {
					has_landed_title = k_dagoth
					has_landed_title = d_dagoth
				}
				NAND = { 
					society_member_of = house_dagoth_council
					is_society_grandmaster = yes
				}	
			}
			character_event = { id = ekmaintenance.3 days = 2 }
			break = yes
		}
		
		if = {
			limit = { 
				OR = {
					has_landed_title = k_veloth
					has_landed_title = d_veloth
				}
				NOT = { trait = house_veloth }
			}
			character_event = { id = ekmaintenance.2 days = 2 }
			break = yes
		}
		if = {
			limit = { 
				trait = house_veloth
				OR = {
					has_landed_title = k_veloth
					has_landed_title = d_veloth
				}
				NAND = { 
					society_member_of = house_veloth_council
					is_society_grandmaster = yes
				}	
			}
			character_event = { id = ekmaintenance.3 days = 2 }
			break = yes
		}
	}
}

character_event = { #You own a Great House but is not a member of the House
	id = ekmaintenance.2
	title = ekmaintenance.2.title
	desc = ekmaintenance.2.desc
	picture = GFX_evt_battle_dunmer
	is_triggered_only = yes
	
	#Give it to its rightful owner
	option = {
		name = ekmaintenance.2.redistribute
		
		ai_chance = {
			factor = 70
		}
		
		trigger = {
			OR = {
				ai = no
				OR = {
					has_house_trait_including_houseless = yes
					culture = dunmer
					culture = chimer
					religion = almsivi
				}
			}
			OR = {
				AND = {
					OR = { 
						has_landed_title = k_hlaalu
						has_landed_title = d_hlaalu
					}
					any_society_member = {
						society_member_of = house_hlaalu_council
						is_society_grandmaster = yes
					}
				}
				AND = {
					OR = { 
						has_landed_title = k_redoran
						has_landed_title = d_redoran
					}
					any_society_member = {
						society_member_of = house_redoran_council
						is_society_grandmaster = yes
					}
				}
				AND = {
					OR = { 
						has_landed_title = k_dres
						has_landed_title = d_dres
					}
					any_society_member = {
						society_member_of = house_dres_council
						is_society_grandmaster = yes
					}
				}
				AND = {
					OR = { 
						has_landed_title = k_indoril
						has_landed_title = d_indoril
					}
					any_society_member = {
						society_member_of = house_indoril_council
						is_society_grandmaster = yes
					}
				}
				AND = {
					OR = { 
						has_landed_title = k_telvanni
						has_landed_title = d_telvanni
					}
					any_society_member = {
						society_member_of = house_telvanni_council
						is_society_grandmaster = yes
					}
				}
				AND = {
					OR = { 
						has_landed_title = k_sul
						has_landed_title = d_sul
					}
					any_society_member = {
						society_member_of = house_sul_council
						is_society_grandmaster = yes
					}
				}
				AND = {
					OR = { 
						has_landed_title = k_dagoth
						has_landed_title = d_dagoth
					}
					any_society_member = {
						society_member_of = house_dagoth_council
						is_society_grandmaster = yes
					}
				}
				AND = {
					OR = { 
						has_landed_title = k_sadras
						has_landed_title = d_sadras
					}
					any_society_member = {
						society_member_of = house_sadras_council
						is_society_grandmaster = yes
					}
				}
				AND = {
					OR = { 
						has_landed_title = k_veloth
						has_landed_title = d_veloth
					}
					any_society_member = {
						society_member_of = house_veloth_council
						is_society_grandmaster = yes
					}
				}
			}
		}
		
		prestige = 500
		piety = 200
		
		if = {
			limit = { has_landed_title = k_hlaalu }
			random_society_member = {
				limit = {
					society_member_of = house_hlaalu_council
					is_society_grandmaster = yes
				}
				k_hlaalu = { grant_title = PREV }
				character_event = { id = ekmaintenance.4 }
			}
			break = yes			
		}
		if = {
			limit = { has_landed_title = d_hlaalu }
			random_society_member = {
				limit = {
					society_member_of = house_hlaalu_council
					is_society_grandmaster = yes
				}
				d_hlaalu = { grant_title = PREV }
				character_event = { id = ekmaintenance.4 }
			}
			break = yes			
		}
		
		if = {
			limit = { has_landed_title = k_redoran }
			random_society_member = {
				limit = {
					society_member_of = house_redoran_council
					is_society_grandmaster = yes
				}
				k_redoran = { grant_title = PREV }
				character_event = { id = ekmaintenance.4 }
			}
			break = yes	
		}
		if = {
			limit = { has_landed_title = d_redoran }
			random_society_member = {
				limit = {
					society_member_of = house_redoran_council
					is_society_grandmaster = yes
				}
				d_redoran = { grant_title = PREV }
				character_event = { id = ekmaintenance.4 }
			}
			break = yes			
		}
		
		if = {
			limit = { has_landed_title = k_telvanni }
			random_society_member = {
				limit = {
					society_member_of = house_telvanni_council
					is_society_grandmaster = yes
				}
				k_telvanni = { grant_title = PREV }
				character_event = { id = ekmaintenance.4 }
			}
			break = yes			
		}
		if = {
			limit = { has_landed_title = d_telvanni }
			random_society_member = {
				limit = {
					society_member_of = house_telvanni_council
					is_society_grandmaster = yes
				}
				d_telvanni = { grant_title = PREV }
				character_event = { id = ekmaintenance.4 }
			}
			break = yes
		}
		
		if = {
			limit = { has_landed_title = k_dres }
			random_society_member = {
				limit = {
					society_member_of = house_dres_council
					is_society_grandmaster = yes
				}
				k_dres = { grant_title = PREV }
				character_event = { id = ekmaintenance.4 }
			}
			break = yes			
		}
		if = {
			limit = { has_landed_title = d_dres }
			random_society_member = {
				limit = {
					society_member_of = house_dres_council
					is_society_grandmaster = yes
				}
				d_dres = { grant_title = PREV }
				character_event = { id = ekmaintenance.4 }
			}
			break = yes			
		}
		
		if = {
			limit = { has_landed_title = k_indoril }
			random_society_member = {
				limit = {
					society_member_of = house_indoril_council
					is_society_grandmaster = yes
				}
				k_indoril = { grant_title = PREV }
				character_event = { id = ekmaintenance.4 }
			}	
			break = yes			
		}
		if = {
			limit = { has_landed_title = d_indoril }
			random_society_member = {
				limit = {
					society_member_of = house_indoril_council
					is_society_grandmaster = yes
				}
				d_indoril = { grant_title = PREV }
				character_event = { id = ekmaintenance.4 }
			}
			break = yes			
		}
		
		if = {
			limit = { has_landed_title = k_sadras }
			random_society_member = {
				limit = {
					society_member_of = house_sadras_council
					is_society_grandmaster = yes
				}
				k_sadras = { grant_title = PREV }
				character_event = { id = ekmaintenance.4 }
			}
			break = yes			
		}
		if = {
			limit = { has_landed_title = d_sadras }
			random_society_member = {
				limit = {
					society_member_of = house_sadras_council
					is_society_grandmaster = yes
				}
				d_sadras = { grant_title = PREV }
				character_event = { id = ekmaintenance.4 }
			}
			break = yes			
		}
		
		if = {
			limit = { has_landed_title = k_veloth }
			random_society_member = {
				limit = {
					society_member_of = house_veloth_council
					is_society_grandmaster = yes
				}
				k_veloth = { grant_title = PREV }
				character_event = { id = ekmaintenance.4 }
			}
			break = yes
		}
		if = {
			limit = { has_landed_title = d_veloth }
			random_society_member = {
				limit = {
					society_member_of = house_veloth_council
					is_society_grandmaster = yes
				}
				d_veloth = { grant_title = PREV }
				character_event = { id = ekmaintenance.4 }
			}
			break = yes
		}
		
		if = {
			limit = { has_landed_title = k_sul }
			random_society_member = {
				limit = {
					society_member_of = house_sul_council
					is_society_grandmaster = yes
				}
				k_sul = { grant_title = PREV }
				character_event = { id = ekmaintenance.4 }
			}		
			break = yes
		}
		if = {
			limit = { has_landed_title = d_sul }
			random_society_member = {
				limit = {
					society_member_of = house_sul_council
					is_society_grandmaster = yes
				}
				d_sul = { grant_title = PREV }
				character_event = { id = ekmaintenance.4 }
			}
			break = yes
		}
		
		if = {
			limit = { has_landed_title = k_dagoth }
			random_society_member = {
				limit = {
					society_member_of = house_dagoth_council
					is_society_grandmaster = yes
				}
				k_dagoth = { grant_title = PREV }
				character_event = { id = ekmaintenance.4 }
			}
			break = yes
		}
		if = {
			limit = { has_landed_title = d_dagoth }
			random_society_member = {
				limit = {
					society_member_of = house_dagoth_council
					is_society_grandmaster = yes
				}
				d_dagoth = { grant_title = PREV }
				character_event = { id = ekmaintenance.4 }
			}
			break = yes
		}
	}
	
	#Destroy the title
	option = {
		name = ekmaintenance.2.destroy
		
		trigger = {
			OR = {
				AND = {
					ai = no
					has_house_trait = no
				}
				NOR = {
					religion = almsivi
					culture = dunmer
					culture = chimer
					has_house_trait = yes
				}
				religion = sixth_house
				trait = house_dagoth
			}
		}
		
		ai_chance = {
			factor = 20
			modifier = {
				factor = 0.5
				OR = {
					has_house_trait = yes
					trait = content
					trait = slothful
					trait = charitable
					trait = kind
					trait = just
					dynasty = 160003 #Dres
					dynasty = 160004 #Indoril
					dynasty = 160005 #Telvanni
					dynasty = 160002 #Hlaalu
					dynasty = 160001 #Redoran
					dynasty = 160773 #Sadras
					dynasty = 160777 #Dagoth
					dynasty = 160775 #Sul
					dynasty = 160662 #Veloth
				}
			}
		}
		
		hidden_tooltip = {
			any_playable_ruler = {
				limit = { 
					OR = {
						trait = house_hlaalu
						trait = house_dres
						trait = house_telvanni
						trait = house_redoran
						trait = house_indoril
						trait = house_dagoth
						trait = house_veloth
						trait = house_sul
						trait = house_sadras
					}
				}
				character_event = { id = ekmaintenance.5 days = 1 }
			}
		}
		
		if = {
			limit = { has_house_trait = yes }
			prestige = -1000
			piety = -500
		}
		
		if = {
			limit = {
				OR = {
					has_landed_title = d_hlaalu
					has_landed_title = k_hlaalu
				}
			}
			d_hlaalu = { destroy_landed_title = THIS }
			k_hlaalu = { destroy_landed_title = THIS }
			hidden_tooltip = {
				set_global_flag = house_hlaalu_extinct
				any_society_member = {
					limit = { society_member_of = house_hlaalu_council }
					leave_society = yes
				}
			}
			break = yes
		}
		
		if = {
			limit = {
				OR = {
					has_landed_title = d_indoril
					has_landed_title = k_indoril
				}
			}
			d_indoril = { destroy_landed_title = THIS }
			k_indoril = { destroy_landed_title = THIS }
			hidden_tooltip = {
				set_global_flag = house_indoril_extinct
				any_society_member = {
					limit = { society_member_of = house_indoril_council }
					leave_society = yes
				}
			}
			break = yes
		}
		
		if = {
			limit = {
				OR = {
					has_landed_title = d_dres
					has_landed_title = k_dres
				}
			}
			d_dres = { destroy_landed_title = THIS }
			k_dres = { destroy_landed_title = THIS }
			hidden_tooltip = {
				set_global_flag = house_dres_extinct
				any_society_member = {
					limit = { society_member_of = house_dres_council }
					leave_society = yes
				}
			}
			break = yes
		}
		
		if = {
			limit = {
				OR = {
					has_landed_title = d_redoran
					has_landed_title = k_redoran
				}
			}
			d_redoran = { destroy_landed_title = THIS }
			k_redoran = { destroy_landed_title = THIS }
			set_global_flag = house_redoran_extinct
			hidden_tooltip = {
				any_society_member = {
					limit = { society_member_of = house_redoran_council }
					leave_society = yes
				}
			}
			break = yes
		}
		
		if = {
			limit = {
				OR = {
					has_landed_title = d_telvanni
					has_landed_title = k_telvanni
				}
			}
			d_telvanni = { destroy_landed_title = THIS }
			k_telvanni = { destroy_landed_title = THIS }
			set_global_flag = house_telvanni_extinct
			hidden_tooltip = {
				any_society_member = {
					limit = { society_member_of = house_telvanni_council }
					leave_society = yes
				}
			}
			break = yes
		}
		
		if = {
			limit = {
				OR = {
					has_landed_title = d_sadras
					has_landed_title = k_sadras
				}
			}
			set_global_flag = house_sadras_extinct
			d_sadras = { destroy_landed_title = THIS }
			k_sadras = { destroy_landed_title = THIS }
			hidden_tooltip = {
				any_society_member = {
					limit = { society_member_of = house_sadras_council }
					leave_society = yes
				}
			}
			break = yes
		}
		
		if = {
			limit = {
				OR = {
					has_landed_title = d_dagoth
					has_landed_title = k_dagoth
				}
			}
			set_global_flag = house_dagoth_extinct
			d_dagoth = { destroy_landed_title = THIS }
			k_dagoth = { destroy_landed_title = THIS }
			hidden_tooltip = {
				any_society_member = {
					limit = { society_member_of = house_dagoth_council }
					leave_society = yes
				}
			}
			break = yes
		}
		
		if = {
			limit = {
				OR = {
					has_landed_title = d_veloth
					has_landed_title = k_veloth
				}
			}
			d_veloth = { destroy_landed_title = THIS }
			k_veloth = { destroy_landed_title = THIS }
			hidden_tooltip = {
				any_society_member = {
					limit = { society_member_of = house_veloth_council }
					leave_society = yes
				}
			}
			break = yes
		}
		
		if = {
			limit = {
				OR = {
					has_landed_title = d_sul
					has_landed_title = k_sul
				}
			}
			d_sul = { destroy_landed_title = THIS }
			k_sul = { destroy_landed_title = THIS }
			hidden_tooltip = {
				any_society_member = {
					limit = { society_member_of = house_sul_council }
					leave_society = yes
				}
			}
		}
		break = yes
	}
	
	#Usurp the title from its rightful owner
	option = {
		name = ekmaintenance.2.usurp
		
		trigger = {
			#Can't usurp if you're Grandmaster of another Great House
			NOT = {
				calc_true_if = {
					amount = 2
					has_landed_title = k_hlaalu
					has_landed_title = d_hlaalu
					has_landed_title = k_redoran
					has_landed_title = d_redoran
					has_landed_title = k_dres
					has_landed_title = d_dres
					has_landed_title = k_indoril
					has_landed_title = d_indoril
					has_landed_title = k_telvanni
					has_landed_title = d_telvanni
					has_landed_title = k_sul
					has_landed_title = d_sul
					has_landed_title = k_dagoth
					has_landed_title = d_dagoth
					has_landed_title = k_sadras
					has_landed_title = d_sadras
					has_landed_title = k_veloth
					has_landed_title = d_veloth
				}
			}
			OR = {
				culture = dunmer
				culture = ashlander
				culture = chimer
				is_dunmer = yes
				religion = almsivi
			}
		}
		
		ai_chance = {
			factor = 30
			
			modifier = {
				factor = 0.75
				OR = {
					trait = just
					trait = kind
					trait = content
				}
			}
		}
		
		set_character_flag = usurped_great_house
		
		if = {
			limit = { has_landed_title = k_hlaalu }
			random_society_member = {
				limit = {
					society_member_of = house_hlaalu_council
					is_society_grandmaster = yes
				}
				add_rival = ROOT
				add_claim = k_hlaalu
				set_character_flag = had_great_house_usurped
			}
			add_trait = house_hlaalu
			if = { limit = { is_in_society = yes } leave_society = yes }
			join_society = house_hlaalu_council
			hidden_tooltip = { set_society_grandmaster = yes }
			break = yes
		}
		if = {
			limit = { has_landed_title = d_hlaalu }
			random_society_member = {
				limit = {
					society_member_of = house_hlaalu_council
					is_society_grandmaster = yes
				}
				hidden_tooltip = { set_society_grandmaster = no }
				add_rival = ROOT
				add_claim = d_hlaalu
				set_character_flag = had_great_house_usurped
			}
			add_trait = house_hlaalu
			if = { limit = { is_in_society = yes } leave_society = yes }
			join_society = house_hlaalu_council
			hidden_tooltip = { set_society_grandmaster = yes }
			break = yes			
		}
		
		if = {
			limit = { has_landed_title = k_redoran }
			random_society_member = {
				limit = {
					society_member_of = house_redoran_council
					is_society_grandmaster = yes
				}
				hidden_tooltip = { set_society_grandmaster = no }
				add_rival = ROOT
				add_claim = k_redoran
				set_character_flag = had_great_house_usurped
			}
			add_trait = house_redoran
			if = { limit = { is_in_society = yes } leave_society = yes }
			join_society = house_redoran_council
			hidden_tooltip = { set_society_grandmaster = yes }
			break = yes
		}
		if = {
			limit = { has_landed_title = d_redoran }
			random_society_member = {
				limit = {
					society_member_of = house_redoran_council
					is_society_grandmaster = yes
				}
				hidden_tooltip = { set_society_grandmaster = no }
				add_rival = ROOT
				add_claim = d_redoran
				set_character_flag = had_great_house_usurped
			}
			add_trait = house_redoran
			if = { limit = { is_in_society = yes } leave_society = yes }
			join_society = house_redoran_council
			hidden_tooltip = { set_society_grandmaster = yes }
			break = yes			
		}
		
		if = {
			limit = { has_landed_title = k_telvanni }
			random_society_member = {
				limit = {
					society_member_of = house_telvanni_council
					is_society_grandmaster = yes
				}
				hidden_tooltip = { set_society_grandmaster = no }
				add_rival = ROOT
				add_claim = k_telvanni
				set_character_flag = had_great_house_usurped
			}
			add_trait = house_telvanni
			if = { limit = { is_in_society = yes } leave_society = yes }
			join_society = house_telvanni_council
			hidden_tooltip = { set_society_grandmaster = yes }
			break = yes
		}
		if = {
			limit = { has_landed_title = d_telvanni }
			random_society_member = {
				limit = {
					society_member_of = house_telvanni_council
					is_society_grandmaster = yes
				}
				hidden_tooltip = { set_society_grandmaster = no }
				add_rival = ROOT
				add_claim = d_telvanni
				set_character_flag = had_great_house_usurped
			}
			add_trait = house_telvanni
			if = { limit = { is_in_society = yes } leave_society = yes }
			join_society = house_telvanni_council
			hidden_tooltip = { set_society_grandmaster = yes }
			break = yes			
		}
		
		if = {
			limit = { has_landed_title = k_dres }
			random_society_member = {
				limit = {
					society_member_of = house_dres_council
					is_society_grandmaster = yes
				}
				hidden_tooltip = { set_society_grandmaster = no }
				add_rival = ROOT
				add_claim = k_dres
				set_character_flag = had_great_house_usurped
			}			
			add_trait = house_dres
			if = { limit = { is_in_society = yes } leave_society = yes }
			join_society = house_dres_council
			hidden_tooltip = { set_society_grandmaster = yes }
			break = yes
		}
		if = {
			limit = { has_landed_title = d_dres }
			random_society_member = {
				limit = {
					society_member_of = house_dres_council
					is_society_grandmaster = yes
				}
				hidden_tooltip = { set_society_grandmaster = no }
				add_rival = ROOT
				add_claim = d_dres
				set_character_flag = had_great_house_usurped
			}			
			add_trait = house_dres
			if = { limit = { is_in_society = yes } leave_society = yes }
			join_society = house_dres_council
			hidden_tooltip = { set_society_grandmaster = yes }
			break = yes
		}
		
		if = {
			limit = { has_landed_title = k_indoril }
			random_society_member = {
				limit = {
					society_member_of = house_indoril_council
					is_society_grandmaster = yes
				}
				hidden_tooltip = { set_society_grandmaster = no }
				add_rival = ROOT
				add_claim = k_indoril
				set_character_flag = had_great_house_usurped
			}			
			add_trait = house_indoril
			if = { limit = { is_in_society = yes } leave_society = yes }
			join_society = house_indoril_council
			hidden_tooltip = { set_society_grandmaster = yes }
			break = yes			
		}
		if = {
			limit = { has_landed_title = d_indoril }
			random_society_member = {
				limit = {
					society_member_of = house_indoril_council
					is_society_grandmaster = yes
				}
				hidden_tooltip = { set_society_grandmaster = no }
				add_rival = ROOT
				add_claim = d_indoril
				set_character_flag = had_great_house_usurped
			}			
			add_trait = house_indoril
			if = { limit = { is_in_society = yes } leave_society = yes }
			join_society = house_indoril_council
			hidden_tooltip = { set_society_grandmaster = yes }
			break = yes
		}
		
		if = {
			limit = { has_landed_title = k_sadras }
			random_society_member = {
				limit = {
					society_member_of = house_sadras_council
					is_society_grandmaster = yes
				}
				hidden_tooltip = { set_society_grandmaster = no }
				add_rival = ROOT
				add_claim = k_sadras
				set_character_flag = had_great_house_usurped
			}			
			add_trait = house_sadras
			if = { limit = { is_in_society = yes } leave_society = yes }
			join_society = house_sadras_council
			hidden_tooltip = { set_society_grandmaster = yes }
			break = yes
		}
		if = {
			limit = { has_landed_title = d_sadras }
			random_society_member = {
				limit = {
					society_member_of = house_sadras_council
					is_society_grandmaster = yes
				}
				hidden_tooltip = { set_society_grandmaster = no }
				add_rival = ROOT
				add_claim = d_sadras
				set_character_flag = had_great_house_usurped
			}		
			add_trait = house_sadras
			if = { limit = { is_in_society = yes } leave_society = yes }
			join_society = house_sadras_council
			hidden_tooltip = { set_society_grandmaster = yes }
			break = yes			
		}
		
		if = {
			limit = { has_landed_title = k_veloth }
			random_society_member = {
				limit = {
					society_member_of = house_veloth_council
					is_society_grandmaster = yes
				}
				hidden_tooltip = { set_society_grandmaster = no }
				add_rival = ROOT
				add_claim = k_veloth
				set_character_flag = had_great_house_usurped
			}		
			add_trait = house_veloth
			if = { limit = { is_in_society = yes } leave_society = yes }
			join_society = house_veloth_council
			hidden_tooltip = { set_society_grandmaster = yes }
			break = yes				
		}
		if = {
			limit = { has_landed_title = d_veloth }
			random_society_member = {
				limit = {
					society_member_of = house_veloth_council
					is_society_grandmaster = yes
				}
				hidden_tooltip = { set_society_grandmaster = no }
				add_rival = ROOT
				add_claim = d_veloth
				set_character_flag = had_great_house_usurped
			}			
			add_trait = house_veloth
			if = { limit = { is_in_society = yes } leave_society = yes }
			join_society = house_veloth_council
			hidden_tooltip = { set_society_grandmaster = yes }
			break = yes
		}
		
		if = {
			limit = { has_landed_title = k_sul }
			random_society_member = {
				limit = {
					society_member_of = house_sul_council
					is_society_grandmaster = yes
				}
				hidden_tooltip = { set_society_grandmaster = no }
				add_rival = ROOT
				add_claim = k_sul
				set_character_flag = had_great_house_usurped
			}			
			add_trait = house_sul
			if = { limit = { is_in_society = yes } leave_society = yes }
			join_society = house_sul_council
			hidden_tooltip = { set_society_grandmaster = yes }
			break = yes
		}
		if = {
			limit = { has_landed_title = d_sul }
			random_society_member = {
				limit = {
					society_member_of = house_sul_council
					is_society_grandmaster = yes
				}
				hidden_tooltip = { set_society_grandmaster = no }
				add_rival = ROOT
				add_claim = d_sul
				set_character_flag = had_great_house_usurped
			}			
			add_trait = house_sul
			if = { limit = { is_in_society = yes } leave_society = yes }
			join_society = house_sul_council
			hidden_tooltip = { set_society_grandmaster = yes }
			break = yes
		}
		
		if = {
			limit = { has_landed_title = k_dagoth }
			random_society_member = {
				limit = {
					society_member_of = house_dagoth_council
					is_society_grandmaster = yes
				}
				hidden_tooltip = { set_society_grandmaster = no }
				add_rival = ROOT
				add_claim = k_dagoth
				set_character_flag = had_great_house_usurped
			}			
			add_trait = house_dagoth
			if = { limit = { is_in_society = yes } leave_society = yes }
			join_society = house_dagoth_council
			hidden_tooltip = { set_society_grandmaster = yes }	
			break = yes
		}
		if = {
			limit = { has_landed_title = d_dagoth }
			random_society_member = {
				limit = {
					society_member_of = house_dagoth_council
					is_society_grandmaster = yes
				}
				hidden_tooltip = { set_society_grandmaster = no }
				add_rival = ROOT
				add_claim = d_dagoth
				set_character_flag = had_great_house_usurped
			}			
			add_trait = house_dagoth
			if = { limit = { is_in_society = yes } leave_society = yes }
			join_society = house_dagoth_council
			hidden_tooltip = { set_society_grandmaster = yes }
			break = yes
		}
	}
	
	after = {
		clr_character_flag = running_maintenance
	}
}

character_event = { #You got a Great House but is not Grandmaster of the House
	id = ekmaintenance.3
	title = ekmaintenance.3.title
	desc = ekmaintenance.3.desc
	picture = GFX_evt_council_dunmer
	is_triggered_only = yes
	
	#Failsafe Description
	desc = {
		
		trigger = {
			is_great_house_grandmaster = yes
		}
		
		text = ekmaintenance.3.grandmaster.desc
		
	}
	
	#Failsafe Option
	option = {
		name = ekmaintenance.3.grandmaster
		
		trigger = {
			is_great_house_grandmaster = yes
		}
		
		prestige = 50
		piety = 50
		if = { limit = { is_great_house_grandmaster = no } character_event = { id = ekmaintenance.3 days = 5 } }
	}
	
	#Personally become Grandmaster
	option = {
		name = ekmaintenance.3.usurp
		
		trigger = {
			is_great_house_grandmaster = no
		}
		
		ai_chance = {
			factor = 80
		}
		
		if = {
			limit = { OR = { has_landed_title = k_hlaalu has_landed_title = d_hlaalu } }
			if = { limit = { is_in_society = yes } leave_society = yes }
			join_society = house_hlaalu_council
			hidden_tooltip = { set_society_grandmaster = yes }
			break = yes
		}
		if = {
			limit = { OR = { has_landed_title = k_redoran has_landed_title = d_redoran } }
			if = { limit = { is_in_society = yes } leave_society = yes }
			join_society = house_redoran_council
			hidden_tooltip = { set_society_grandmaster = yes }
			break = yes
		}
		if = {
			limit = { OR = { has_landed_title = k_telvanni has_landed_title = d_telvanni } }
			if = { limit = { is_in_society = yes } leave_society = yes }
			join_society = house_telvanni_council
			hidden_tooltip = { set_society_grandmaster = yes }
			break = yes
		}
		if = {
			limit = { OR = { has_landed_title = k_dres has_landed_title = d_dres } }			
			if = { limit = { is_in_society = yes } leave_society = yes }
			join_society = house_dres_council
			hidden_tooltip = { set_society_grandmaster = yes }
			break = yes
		}
		if = {
			limit = { OR = { has_landed_title = k_indoril has_landed_title = d_indoril } }			
			if = { limit = { is_in_society = yes } leave_society = yes }
			join_society = house_indoril_council
			hidden_tooltip = { set_society_grandmaster = yes }
			break = yes
		}
		if = {
			limit = { OR = { has_landed_title = k_sadras has_landed_title = d_sadras } }		
			if = { limit = { is_in_society = yes } leave_society = yes }
			join_society = house_sadras_council
			hidden_tooltip = { set_society_grandmaster = yes }
			break = yes
		}
		if = {
			limit = { OR = { has_landed_title = k_veloth has_landed_title = d_veloth } }
			if = { limit = { is_in_society = yes } leave_society = yes }
			join_society = house_veloth_council
			hidden_tooltip = { set_society_grandmaster = yes }
			break = yes
		}
		if = {
			limit = { OR = { has_landed_title = k_sul has_landed_title = d_sul } }
			if = { limit = { is_in_society = yes } leave_society = yes }
			join_society = house_sul_council
			hidden_tooltip = { set_society_grandmaster = yes }
			break = yes
		}
		if = {
			limit = { OR = { has_landed_title = k_dagoth has_landed_title = d_dagoth } }			
			if = { limit = { is_in_society = yes } leave_society = yes }
			join_society = house_dagoth_council
			hidden_tooltip = { set_society_grandmaster = yes }
			break = yes
		}
	}
	
	#I'll appoint a Mouth later
	option = {
		name = ekgreathouses.101.opt2
		
		trigger = {
			is_great_house_grandmaster = yes
			NOT = {
				any_courtier_or_vassal = {
					has_minor_title = title_mouth
					liege = { character = ROOT }
				}
			}
		}
		
		ai_chance = {
			factor = 0
		}
		
		if = {
			limit = {
				OR = {
					society_member_of = house_hlaalu_council
					society_member_of = house_redoran_council
					society_member_of = house_dres_council
					society_member_of = house_telvanni_council
					society_member_of = house_indoril_council
					society_member_of = house_sadras_council
					society_member_of = house_veloth_council
					society_member_of = house_sul_council
					society_member_of = house_dagoth_council
				}
			}
			if = { limit = { is_in_society = yes } leave_society = yes }
		}
		
		set_character_flag = wants_mouth_in_council
		add_character_modifier = { name = no_house_council_representation duration = -1 }
	}
	
	#Appoint Mouth as Grandmaster
	option = {
		name = ekmaintenance.3.councilor
		
		trigger = {
			is_great_house_grandmaster = yes
			any_courtier_or_vassal = {
				has_minor_title = title_mouth
				liege = { character = ROOT }
			}
		}
		
		ai_chance = {
			factor = 20
		}
		
		if = {
			limit = {
				OR = {
					society_member_of = house_hlaalu_council
					society_member_of = house_redoran_council
					society_member_of = house_dres_council
					society_member_of = house_telvanni_council
					society_member_of = house_indoril_council
					society_member_of = house_sadras_council
					society_member_of = house_veloth_council
					society_member_of = house_sul_council
					society_member_of = house_dagoth_council
				}
			}
			if = { limit = { is_in_society = yes } leave_society = yes }
		}
		
		if = {
			limit = { 
				OR = {
					has_landed_title = k_hlaalu
					has_landed_title = d_hlaalu
				}
			}
			random_courtier_or_vassal = {
				limit = {
					has_minor_title = title_mouth
					liege = { character = ROOT }
				}
				if = { limit = { is_in_society = yes } leave_society = yes }
				join_society = house_hlaalu_council
				set_society_grandmaster = yes
				set_character_flag = mouth_in_council
			}
			break = yes
		}
		if = {
			limit = { 
				OR = {
					has_landed_title = k_redoran
					has_landed_title = d_redoran
				}
			}
			random_courtier_or_vassal = {
				limit = {
					has_minor_title = title_mouth
					liege = { character = ROOT }
				}
				if = { limit = { is_in_society = yes } leave_society = yes }
				join_society = house_redoran_council
				set_society_grandmaster = yes
				set_character_flag = mouth_in_council
			}
			break = yes
		}
		if = {
			limit = { 
				OR = {
					has_landed_title = k_dres
					has_landed_title = d_dres
				}
			}
			random_courtier_or_vassal = {
				limit = {
					has_minor_title = title_mouth
					liege = { character = ROOT }
				}
				if = { limit = { is_in_society = yes } leave_society = yes }
				join_society = house_dres_council
				set_society_grandmaster = yes
				set_character_flag = mouth_in_council
			}
			break = yes
		}
		if = {
			limit = { 
				OR = {
					has_landed_title = k_indoril
					has_landed_title = d_indoril
				}
			}
			random_courtier_or_vassal = {
				limit = {
					has_minor_title = title_mouth
					liege = { character = ROOT }
				}
				if = { limit = { is_in_society = yes } leave_society = yes }
				join_society = house_indoril_council
				set_society_grandmaster = yes
				set_character_flag = mouth_in_council
			}
			break = yes
		}
		if = {
			limit = { 
				OR = {
					has_landed_title = k_telvanni
					has_landed_title = d_telvanni
				}
			}
			random_courtier_or_vassal = {
				limit = {
					has_minor_title = title_mouth
					liege = { character = ROOT }
				}
				if = { limit = { is_in_society = yes } leave_society = yes }
				join_society = house_telvanni_council
				set_society_grandmaster = yes
				set_character_flag = mouth_in_council
			}
			break = yes
		}
		if = {
			limit = { 
				OR = {
					has_landed_title = k_sadras
					has_landed_title = d_sadras
				}
			}
			random_courtier_or_vassal = {
				limit = {
					has_minor_title = title_mouth
					liege = { character = ROOT }
				}
				if = { limit = { is_in_society = yes } leave_society = yes }
				join_society = house_sadras_council
				set_society_grandmaster = yes
				set_character_flag = mouth_in_council
			}
			break = yes
		}
		if = {
			limit = { 
				OR = {
					has_landed_title = k_veloth
					has_landed_title = d_veloth
				}
			}
			random_courtier_or_vassal = {
				limit = {
					has_minor_title = title_mouth
					liege = { character = ROOT }
				}
				if = { limit = { is_in_society = yes } leave_society = yes }
				join_society = house_veloth_council
				set_society_grandmaster = yes
				set_character_flag = mouth_in_council
			}
			break = yes
		}
		if = {
			limit = { 
				OR = {
					has_landed_title = k_dagoth
					has_landed_title = d_dagoth
				}
			}
			random_courtier_or_vassal = {
				limit = {
					has_minor_title = title_mouth
					liege = { character = ROOT }
				}
				if = { limit = { is_in_society = yes } leave_society = yes }
				join_society = house_dagoth_council
				set_society_grandmaster = yes
				set_character_flag = mouth_in_council
			}
			break = yes
		}
		if = {
			limit = { 
				OR = {
					has_landed_title = k_sul
					has_landed_title = d_sul
				}
			}
			random_courtier_or_vassal = {
				limit = {
					has_minor_title = title_mouth
					liege = { character = ROOT }
				}
				if = { limit = { is_in_society = yes } leave_society = yes }
				join_society = house_sul_council
				set_society_grandmaster = yes
				set_character_flag = mouth_in_council
			}
			break = yes
		}
	}
	
	#Return title to current Grandmaster
	option = {
		name = ekmaintenance.3.notcouncilor
		
		trigger = {
			is_great_house_grandmaster = no
		}
		
		ai_chance = {
			factor = 0
		}
		
		prestige = -250
		any_dynasty_member = {
			opinion = {
				modifier = disrespects_dynasty
				who = ROOT
				years = 10
			}
		}
		
		if = {
			limit = { has_landed_title = k_hlaalu }
			random_character = {
				limit = {
					society_member_of = house_hlaalu_council
					is_society_grandmaster = yes
				}
				k_hlaalu = { grant_title = PREV }
				character_event = { id = ekmaintenance.4 }
			}
			break = yes
		}
		if = {
			limit = { has_landed_title = d_hlaalu }
			random_character = {
				limit = {
					society_member_of = house_hlaalu_council
					is_society_grandmaster = yes
				}
				d_hlaalu = { grant_title = PREV }
				character_event = { id = ekmaintenance.4 }
			}
			break = yes
		}
		
		if = {
			limit = { has_landed_title = k_indoril }
			random_character = {
				limit = {
					society_member_of = house_indoril_council
					is_society_grandmaster = yes
				}
				k_indoril = { grant_title = PREV }
				character_event = { id = ekmaintenance.4 }
			}
			break = yes
		}
		if = {
			limit = { has_landed_title = d_indoril }
			random_character = {
				limit = {
					society_member_of = house_indoril_council
					is_society_grandmaster = yes
				}
				d_indoril = { grant_title = PREV }
				character_event = { id = ekmaintenance.4 }
			}
			break = yes
		}
		
		if = {
			limit = { has_landed_title = k_redoran }
			random_character = {
				limit = {
					society_member_of = house_redoran_council
					is_society_grandmaster = yes
				}
				k_redoran = { grant_title = PREV }
				character_event = { id = ekmaintenance.4 }
			}
			break = yes
		}
		if = {
			limit = { has_landed_title = d_redoran }
			random_character = {
				limit = {
					society_member_of = house_redoran_council
					is_society_grandmaster = yes
				}
				d_redoran = { grant_title = PREV }
				character_event = { id = ekmaintenance.4 }
			}
			break = yes
		}
		
		if = {
			limit = { has_landed_title = k_dres }
			random_character = {
				limit = {
					society_member_of = house_dres_council
					is_society_grandmaster = yes
				}
				k_dres = { grant_title = PREV }
				character_event = { id = ekmaintenance.4 }
			}
			break = yes
		}
		if = {
			limit = { has_landed_title = d_dres }
			random_character = {
				limit = {
					society_member_of = house_dres_council
					is_society_grandmaster = yes
				}
				d_dres = { grant_title = PREV }
				character_event = { id = ekmaintenance.4 }
			}
			break = yes
		}
		
		if = {
			limit = { has_landed_title = k_telvanni }
			random_character = {
				limit = {
					society_member_of = house_telvanni_council
					is_society_grandmaster = yes
				}
				k_telvanni = { grant_title = PREV }
				character_event = { id = ekmaintenance.4 }
			}
			break = yes
		}
		if = {
			limit = { has_landed_title = d_telvanni }
			random_character = {
				limit = {
					society_member_of = house_telvanni_council
					is_society_grandmaster = yes
				}
				d_telvanni = { grant_title = PREV }
				character_event = { id = ekmaintenance.4 }
			}
			break = yes
		}
		
		if = {
			limit = { has_landed_title = k_sadras }
			random_character = {
				limit = {
					society_member_of = house_sadras_council
					is_society_grandmaster = yes
				}
				k_sadras = { grant_title = PREV }
				character_event = { id = ekmaintenance.4 }
			}
			break = yes
		}
		if = {
			limit = { has_landed_title = d_sadras }
			random_character = {
				limit = {
					society_member_of = house_sadras_council
					is_society_grandmaster = yes
				}
				d_sadras = { grant_title = PREV }
				character_event = { id = ekmaintenance.4 }
			}
			break = yes
		}
		
		if = {
			limit = { has_landed_title = k_veloth }
			random_character = {
				limit = {
					society_member_of = house_veloth_council
					is_society_grandmaster = yes
				}
				k_veloth = { grant_title = PREV }
				character_event = { id = ekmaintenance.4 }
			}
			break = yes
		}
		if = {
			limit = { has_landed_title = d_veloth }
			random_character = {
				limit = {
					society_member_of = house_veloth_council
					is_society_grandmaster = yes
				}
				d_veloth = { grant_title = PREV }
				character_event = { id = ekmaintenance.4 }
			}
			break = yes
		}
		
		if = {
			limit = { has_landed_title = k_sul }
			random_character = {
				limit = {
					society_member_of = house_sul_council
					is_society_grandmaster = yes
				}
				k_sul = { grant_title = PREV }
				character_event = { id = ekmaintenance.4 }
			}
			break = yes
		}
		if = {
			limit = { has_landed_title = d_sul }
			random_character = {
				limit = {
					society_member_of = house_sul_council
					is_society_grandmaster = yes
				}
				d_sul = { grant_title = PREV }
				character_event = { id = ekmaintenance.4 }
			}
			break = yes
		}
		
		if = {
			limit = { has_landed_title = k_dagoth }
			random_character = {
				limit = {
					society_member_of = house_dagoth_council
					is_society_grandmaster = yes
				}
				k_dagoth = { grant_title = PREV }
				character_event = { id = ekmaintenance.4 }
			}
			break = yes
		}
		if = {
			limit = { has_landed_title = d_dagoth }
			random_character = {
				limit = {
					society_member_of = house_dagoth_council
					is_society_grandmaster = yes
				}
				d_dagoth = { grant_title = PREV }
				character_event = { id = ekmaintenance.4 }
			}
			break = yes
		}
	}
	
	after = {
		clr_character_flag = running_maintenance
	}
	
}

character_event = { #Informs the new Grandmaster
	id = ekmaintenance.4
	title = ekmaintenance.4.title
	desc = ekmaintenance.4.desc
	picture = GFX_evt_coronation_dunmer
	is_triggered_only = yes
	
	desc = {
		trigger = {
			OR = {
				AND = {
					trait = house_hlaalu
					NOT = { FROM = { trait = house_hlaalu } }
				}
				AND = {
					trait = house_redoran
					NOT = { FROM = { trait = house_redoran } }
				}
				AND = {
					trait = house_dres
					NOT = { FROM = { trait = house_dres } }
				}
				AND = {
					trait = house_indoril
					NOT = { FROM = { trait = house_indoril } }
				}
				AND = {
					trait = house_telvanni
					NOT = { FROM = { trait = house_telvanni } }
				}
				AND = {
					trait = house_sadras
					NOT = { FROM = { trait = house_sadras } }
				}
				AND = {
					trait = house_dagoth
					NOT = { FROM = { trait = house_dagoth } }
				}
				AND = {
					trait = house_veloth
					NOT = { FROM = { trait = house_veloth } }
				}
				AND = {
					trait = house_sul
					NOT = { FROM = { trait = house_sul } }
				}
			}
		}
		text = ekmaintenance.4.desc2
	}
	
	option = {
		name = ekmaintenance.4.option
		prestige = 500
	}
	
	#I'll appoint a Mouth later
	option = {
		name = ekgreathouses.101.opt2
		
		trigger = {
			is_great_house_grandmaster = no
			NOT = {
				any_courtier_or_vassal = {
					has_minor_title = title_mouth
					liege = { character = ROOT }
				}
			}
		}
		
		ai_chance = {
			factor = 0
		}
		
		if = {
			limit = {
				OR = {
					society_member_of = house_hlaalu_council
					society_member_of = house_redoran_council
					society_member_of = house_dres_council
					society_member_of = house_telvanni_council
					society_member_of = house_indoril_council
					society_member_of = house_sadras_council
					society_member_of = house_veloth_council
					society_member_of = house_sul_council
					society_member_of = house_dagoth_council
				}
			}
			if = { limit = { is_in_society = yes } leave_society = yes }
		}
		
		set_character_flag = wants_mouth_in_council
		add_character_modifier = { name = no_house_council_representation duration = -1 }
	}
	
	#Appoint Mouth as Grandmaster
	option = {
		name = ekmaintenance.3.councilor
		
		trigger = {
			is_great_house_grandmaster = no
			any_courtier_or_vassal = {
				has_minor_title = title_mouth
				liege = { character = ROOT }
			}
		}
		
		ai_chance = {
			factor = 20
		}
		
		if = {
			limit = {
				OR = {
					society_member_of = house_hlaalu_council
					society_member_of = house_redoran_council
					society_member_of = house_dres_council
					society_member_of = house_telvanni_council
					society_member_of = house_indoril_council
					society_member_of = house_sadras_council
					society_member_of = house_veloth_council
					society_member_of = house_sul_council
					society_member_of = house_dagoth_council
				}
			}
			if = { limit = { is_in_society = yes } leave_society = yes }
		}
		
		if = {
			limit = { 
				OR = {
					has_landed_title = k_hlaalu
					has_landed_title = d_hlaalu
				}
			}
			random_courtier_or_vassal = {
				limit = {
					has_minor_title = title_mouth
					liege = { character = ROOT }
				}
				if = { limit = { is_in_society = yes } leave_society = yes }
				join_society = house_hlaalu_council
				set_society_grandmaster = yes
				set_character_flag = mouth_in_council
			}
			break = yes
		}
		if = {
			limit = { 
				OR = {
					has_landed_title = k_redoran
					has_landed_title = d_redoran
				}
			}
			random_courtier_or_vassal = {
				limit = {
					has_minor_title = title_mouth
					liege = { character = ROOT }
				}
				if = { limit = { is_in_society = yes } leave_society = yes }
				join_society = house_redoran_council
				set_society_grandmaster = yes
				set_character_flag = mouth_in_council
			}
			break = yes
		}
		if = {
			limit = { 
				OR = {
					has_landed_title = k_dres
					has_landed_title = d_dres
				}
			}
			random_courtier_or_vassal = {
				limit = {
					has_minor_title = title_mouth
					liege = { character = ROOT }
				}
				if = { limit = { is_in_society = yes } leave_society = yes }
				join_society = house_dres_council
				set_society_grandmaster = yes
				set_character_flag = mouth_in_council
			}
			break = yes
		}
		if = {
			limit = { 
				OR = {
					has_landed_title = k_indoril
					has_landed_title = d_indoril
				}
			}
			random_courtier_or_vassal = {
				limit = {
					has_minor_title = title_mouth
					liege = { character = ROOT }
				}
				if = { limit = { is_in_society = yes } leave_society = yes }
				join_society = house_indoril_council
				set_society_grandmaster = yes
				set_character_flag = mouth_in_council
			}
			break = yes
		}
		if = {
			limit = { 
				OR = {
					has_landed_title = k_telvanni
					has_landed_title = d_telvanni
				}
			}
			random_courtier_or_vassal = {
				limit = {
					has_minor_title = title_mouth
					liege = { character = ROOT }
				}
				if = { limit = { is_in_society = yes } leave_society = yes }
				join_society = house_telvanni_council
				set_society_grandmaster = yes
				set_character_flag = mouth_in_council
			}
			break = yes
		}
		if = {
			limit = { 
				OR = {
					has_landed_title = k_sadras
					has_landed_title = d_sadras
				}
			}
			random_courtier_or_vassal = {
				limit = {
					has_minor_title = title_mouth
					liege = { character = ROOT }
				}
				if = { limit = { is_in_society = yes } leave_society = yes }
				join_society = house_sadras_council
				set_society_grandmaster = yes
				set_character_flag = mouth_in_council
			}
			break = yes
		}
		if = {
			limit = { 
				OR = {
					has_landed_title = k_veloth
					has_landed_title = d_veloth
				}
			}
			random_courtier_or_vassal = {
				limit = {
					has_minor_title = title_mouth
					liege = { character = ROOT }
				}
				if = { limit = { is_in_society = yes } leave_society = yes }
				join_society = house_veloth_council
				set_society_grandmaster = yes
				set_character_flag = mouth_in_council
			}
			break = yes
		}
		if = {
			limit = { 
				OR = {
					has_landed_title = k_dagoth
					has_landed_title = d_dagoth
				}
			}
			random_courtier_or_vassal = {
				limit = {
					has_minor_title = title_mouth
					liege = { character = ROOT }
				}
				if = { limit = { is_in_society = yes } leave_society = yes }
				join_society = house_dagoth_council
				set_society_grandmaster = yes
				set_character_flag = mouth_in_council
			}
			break = yes
		}
		if = {
			limit = { 
				OR = {
					has_landed_title = k_sul
					has_landed_title = d_sul
				}
			}
			random_courtier_or_vassal = {
				limit = {
					has_minor_title = title_mouth
					liege = { character = ROOT }
				}
				if = { limit = { is_in_society = yes } leave_society = yes }
				join_society = house_sul_council
				set_society_grandmaster = yes
				set_character_flag = mouth_in_council
			}
		}
	}
}

character_event = { #Inform everyone that the House was destroyed
	id = ekmaintenance.5
	title = ekmaintenance.5.title
	desc = ekmaintenance.5.desc
	picture = GFX_evt_battle_dunmer
	is_triggered_only = yes
	
	option = {
		name = ekmaintenance.5.option
	}	
}

character_event = { #Direnni Naming
	id = ekmaintenance.6
	is_triggered_only = yes #on_new_holder
	hide_window = yes
	
	trigger = {
		NOT = { has_character_flag = running_maintenance } 
		OR = {
			has_landed_title = k_highrock
			has_landed_title = e_breton
		}
	}
	
	immediate = {
		set_character_flag = running_maintenance
		#Kingdom Title
		if = {
			limit = { 
				dynasty = 120001
				independent = yes
				has_landed_title = k_highrock
				NOT = { has_landed_title = e_breton }
				NOT = { e_breton = { holder_scope = { dynasty = 120001 } } }
			}
			k_highrock = { set_name = "Direnni Hegemony" }
		}
		if = {
			limit = { 
				NOT = { dynasty = 120001 }
				has_landed_title = k_highrock 
			}
			k_highrock = { set_name = "" }
		}
		#Empire Title
		if = {
			limit = { 
				dynasty = 120001
				independent = yes
				has_landed_title = e_breton 
			}
			e_breton = { set_name = "Direnni Hegemony" }
		}
		if = {
			limit = { 
				NOT = { dynasty = 120001 }
				has_landed_title = e_breton 
			}
			e_breton = { set_name = "" }
		}
		#Both Titles
		if = {
			limit = { 
				dynasty = 120001
				has_landed_title = e_breton
				OR = {
					has_landed_title = k_highrock
					any_vassal = { has_landed_title = k_highrock }
				}
			}
			k_highrock = { set_name = "" }
		}
		clr_character_flag = running_maintenance
	}
}
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	